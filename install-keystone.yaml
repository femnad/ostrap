---
- hosts: all
  pre_tasks:
    - apt: name={{item}} state=latest
      become: yes
      with_items:
        - mariadb-server
        - crudini
        - python-dev
        - python-pip
        - python-mysqldb
        - python-setuptools
        - rabbitmq-server        
  tasks:
    - script: add-db-admin.sh
    - script: set-hosts.sh controller
    - git: repo=git://git.openstack.org/openstack/keystone dest=~/z/gl/openstack/keystone version=stable/kilo accept_hostkey=yes
    - script: install-keystone.sh
    - mysql_db: name=keystone state=present login_user=boot login_password=borek
    - mysql_user: name=keystone password=keystone priv=*.*:ALL state=present login_user=boot login_password=borek
    - script: bootstrap-keystone.sh
