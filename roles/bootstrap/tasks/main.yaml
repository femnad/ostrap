---
- name: Create keystone service
  environment: "{{admin_bootstrap_environment}}"
  command: "{{virtualenv_bin}}/openstack service create --name keystone --description 'OpenStack Identity' identity"
  tags: identity-service
- name: Add keystone endpoint
  environment: "{{admin_bootstrap_environment}}"
  command: "{{virtualenv_bin}}/openstack endpoint create --publicurl http://{{controller_host}}:5000/v2.0
              --internalurl http://{{controller_host}}:5000/v2.0
              --adminurl http://{{controller_host}}:35357/v2.0 --region {{region}} identity"
  tags: identity-endpoint
- name: Create admin project
  environment: "{{admin_bootstrap_environment}}"
  command: "{{virtualenv_bin}}/openstack project create --description 'Admin Project' admin"
  tags: admin-project
- name: Create admin user
  environment: "{{admin_bootstrap_environment}}"
  command: "{{virtualenv_bin}}/openstack user create --password {{admin_password}} admin"
  tags: admin-user
- name: Create admin role
  environment: "{{admin_bootstrap_environment}}"
  command: "{{virtualenv_bin}}/openstack role create admin"
  tags: admin-role
- name: Add admin role to admin user
  environment: "{{admin_bootstrap_environment}}"
  command: "{{virtualenv_bin}}/openstack role add --project admin --user admin admin"
  tags: admin-role
- name: Create service project
  environment: "{{admin_bootstrap_environment}}"
  command: "{{virtualenv_bin}}/openstack project create --description 'Service Project' service"
  tags: service-project
